# MoEngage Q&A Bot 사용 가이드

CSM 팀을 위한 MoEngage Q&A 봇 사용법입니다.
이 봇은 고객 문의에 대한 답변 초안을 자동으로 생성하고, CSM이 검토/개선한 후 고객에게 전달하는 워크플로우를 지원합니다.

---

## 시작하기 전에

### 필요한 Slack 채널

| 채널 | 용도 |
|------|------|
| **고객 채널** | 고객이 문의를 남기는 채널 (예: `#jinair-support`) |
| **CSM 응답 채널** | 봇이 답변을 게시하는 내부 채널 (관리자가 설정) |

### 봇이 참여해야 하는 채널

봇(`@moengage qna`)이 아래 채널에 모두 초대되어 있어야 합니다:
- 고객 문의가 올라오는 채널
- CSM 응답 채널

> 봇이 채널에 없으면 `/invite @moengage qna` 명령어로 초대하세요.

---

## 전체 흐름 요약

```
고객 문의 → CSM이 🎫 이모지 추가 → 봇이 답변 생성 (CSM 채널에 게시)
    → CSM이 답변 검토/피드백 → 봇이 답변 개선 (반복 가능)
    → CSM이 [📨 고객에게 전달] 버튼 클릭 → 고객 스레드에 답변 자동 게시
    → CSM이 ✅ 이모지 추가 → 히스토리 저장 + 학습 → CSM 스레드에 저장 요약 표시
```

---

## 1단계: 티켓 생성하기

고객이 Slack 채널에 문의를 남기면, 해당 메시지에 **🎫 (`:ticket:`)** 이모지를 추가하세요.

> **이모지 추가 방법**: 메시지에 마우스를 올리고 이모지 버튼 클릭 → `ticket` 검색 → 🎫 선택

봇이 자동으로:
1. MoEngage 공식 문서 + 과거 지원 이력 + 학습 데이터에서 관련 정보 검색
2. Claude AI로 답변 초안 생성
3. **CSM 응답 채널**에 답변을 게시

CSM 응답 채널에 게시되는 메시지 구성:

```
@티켓등록자 님 답변이 작성되었습니다       ← 티켓을 등록한 사람을 태그하여 알림

📋 새로운 문의 #채널명
원본 메시지: 슬랙에서 보기               ← 클릭하면 원본 문의로 이동
고객 문의 내용: (문의 요약)

─────────────────────────────
(봇이 생성한 답변)

🔗 참고 자료
─────────────────────────────

이 답변이 충분하시면 아래 버튼을 눌러 고객에게 전달해주세요.
답변을 개선하려면 이 스레드에 @moengage qna 를 태그해서 피드백을 남겨주세요.

[📨 고객에게 전달]                      ← 버튼
```

> 보통 **30초~1분** 내에 답변이 CSM 채널에 게시됩니다.

---

## 2단계: 답변 검토 및 개선하기

봇이 CSM 채널에 게시한 답변을 읽고 검토합니다.

### 답변이 만족스러운 경우

→ 바로 **[📨 고객에게 전달]** 버튼을 클릭하세요. (3단계로 이동)

### 답변을 개선해야 하는 경우

→ 봇 답변의 **스레드(Thread)**에서 **`@moengage qna`를 태그**하여 피드백을 작성하세요.

```
@moengage qna SDK 버전 관련 문서도 찾아줘
```

피드백 예시:

| 상황 | 피드백 예시 |
|------|------------|
| 추가 검색이 필요할 때 | `@moengage qna SDK 버전 관련 문서도 찾아줘` |
| 맥락 정보를 제공할 때 | `@moengage qna 이 고객사는 React Native SDK를 사용하고 있어` |
| 오류를 지적할 때 | `@moengage qna Push Notification 설정 경로가 틀렸어, 실제로는 Settings > Channel에 있어` |
| 톤/형식을 조정할 때 | `@moengage qna 좀 더 간결하게 핵심만 정리해줘` |

봇이 피드백을 분석하여 **개선된 답변**을 같은 스레드에 게시합니다.
개선된 답변에도 **[📨 고객에게 전달]** 버튼이 포함됩니다.

> 이 과정은 만족할 때까지 **반복**할 수 있습니다.

---

## 3단계: 고객에게 답변 전달하기

답변이 충분하다고 판단되면, 해당 답변의 **[📨 고객에게 전달]** 버튼을 클릭하세요.

봇이 자동으로:
1. 원본 고객 문의 스레드에 답변을 게시합니다
2. CSM 채널의 메시지를 **"✅ 전달 완료"**로 업데이트하고 고객 스레드 링크를 표시합니다

고객에게 전달되는 답변에는 아래 인사말이 자동으로 추가됩니다:
```
안녕하세요. 문의하신 사항에 대해 답변드립니다.
답변내용을 확인하시고 문의사항이 해소가 되지 않으신다면 추가 문의 해주시길 부탁드립니다.

(답변 본문)
```

> **참고**: 여러 번 개선한 경우, 각 답변마다 버튼이 있습니다. 전달하고 싶은 버전의 버튼을 클릭하세요.

---

## 4단계: 티켓 완료하기

고객에게 답변을 전달한 후, **원본 고객 문의 메시지**에 **✅ (`:완료:`)** 이모지를 추가하세요.

> **중요**: ✅ 이모지는 CSM 채널이 아닌, **원본 고객 문의 메시지**에 추가합니다.

봇이 자동으로:
1. 대화 내용을 **지원 히스토리 DB**에 저장합니다
2. 답변 개선 과정에서 **학습 포인트**를 추출합니다
   - 문의 해석 방법
   - 효과적인 검색 전략
   - 좋은 답변 작성법
3. CSM 응답 채널 스레드에 **저장 확인 메시지**를 게시합니다:
   ```
   ✅ history와 학습내용이 저장되었습니다.

   저장 요약
   - 히스토리 ID: abc12345...
   - 학습 ID: def67890...
   - 피드백 횟수: 2회
   - 학습 포인트:
     • 문의 해석: ...
     • 검색 전략: ...
     • 답변 작성: ...
   ```
4. 학습 데이터를 향후 유사 문의의 답변 품질 향상에 자동 활용합니다

---

## 5단계 (선택): 봇에게 직접 질문하기

티켓 워크플로우와 별도로, CSM 채널에서 봇을 **@멘션**하여 자유롭게 질문할 수 있습니다.

```
@moengage qna Segment에서 사용자 필터링하는 방법이 뭐야?
```

- MoEngage 문서 + 과거 지원 이력을 검색하여 답변합니다
- 스레드 내에서 이어서 대화하면 맥락을 유지합니다
- 티켓 생성 없이 빠르게 정보를 확인할 때 유용합니다

---

## 이모지 요약

| 이모지 | 사용 위치 | 기능 |
|--------|----------|------|
| 🎫 `:ticket:` | 고객 문의 메시지 | 티켓 생성 → 봇이 답변 생성 |
| ✅ `:완료:` | 고객 문의 메시지 | 티켓 완료 → 히스토리 저장 + 학습 |
| 👍 `:+1:` | 봇 답변 메시지 | 긍정 피드백 기록 |
| 👎 `:-1:` | 봇 답변 메시지 | 부정 피드백 기록 |

---

## 워크플로우 다이어그램

```
고객 채널                          CSM 응답 채널
─────────                          ──────────────

┌─────────────────┐
│  고객 문의 메시지  │
│  + 🎫 이모지      │
└────────┬────────┘
         │
         │                    ┌──────────────────────────────┐
         └──────────────────→ │  @CSM님 답변이 작성되었습니다    │
                              │  📋 새로운 문의               │
                              │  • 원본 메시지 링크            │
                              │  • 봇 답변 초안               │
                              │  • 참고 자료                  │
                              │  [📨 고객에게 전달]            │
                              └──────────┬───────────────────┘
                                         │
                              ┌──────────▼───────────────────┐
                              │  @moengage qna 피드백 (스레드)  │
                              │  "이 부분 수정해줘..."          │
                              └──────────┬───────────────────┘
                                         │
                              ┌──────────▼───────────────────┐
                              │  📝 개선된 답변 (#1)           │
                              │  [📨 고객에게 전달]            │
                              └──────────┬───────────────────┘
                                         │
                                    버튼 클릭!
                                         │
┌─────────────────┐                      │
│  고객 문의 메시지  │ ◄────────────────────┘
│  └─ 봇 답변      │            답변 자동 게시
│  + ✅ 이모지      │
└─────────────────┘              ┌───────────────────────────┐
   완료 → 학습 저장 ───────────→  │  ✅ 저장 완료 요약 메시지    │
                                 └───────────────────────────┘
```

---

## FAQ

**Q: 🎫 이모지를 잘못 추가했어요.**
A: 이모지를 제거하면 됩니다. 봇이 아직 처리 중이면 자동으로 취소됩니다.

**Q: 봇이 답변을 생성하는 데 시간이 얼마나 걸리나요?**
A: 보통 30초~1분 내에 답변이 CSM 채널에 게시됩니다.

**Q: 피드백을 줄 때 @moengage qna 태그가 필수인가요?**
A: 네. 봇이 스레드 내 메시지를 인식하려면 `@moengage qna`를 태그해야 합니다.

**Q: 전달 버튼을 눌렀는데 다시 누를 수 있나요?**
A: 같은 답변의 버튼은 한 번만 클릭할 수 있습니다. "이미 전달된 답변입니다"라는 안내가 표시됩니다. 다른 버전의 답변을 전달하고 싶다면 해당 답변의 버튼을 사용하세요.

**Q: [고객에게 전달] 버튼 없이 ✅ 이모지만 추가해도 되나요?**
A: 네. 답변을 직접 복사/붙여넣기로 전달한 경우, 버튼을 사용하지 않고 바로 ✅ 이모지를 추가하여 완료 처리할 수 있습니다.

**Q: ✅ 이모지는 어디에 추가하나요?**
A: **원본 고객 문의 메시지**에 추가합니다. CSM 응답 채널의 봇 답변이 아닌, 고객이 문의를 남긴 원본 메시지입니다.

**Q: 봇이 응답하지 않아요.**
A: 다음을 확인해주세요:
1. 봇(`@moengage qna`)이 해당 채널에 초대되어 있는지 확인
2. 올바른 이모지를 사용했는지 확인 (🎫 = `:ticket:`, ✅ = `:완료:`)
3. 문제가 지속되면 관리자에게 문의하세요

**Q: 학습 데이터는 어떻게 활용되나요?**
A: ✅ 완료 시 추출된 학습 포인트(문의 해석, 검색 전략, 답변 작성법)는 이후 유사한 문의가 들어올 때 자동으로 검색되어 답변 품질을 높이는 데 활용됩니다. 피드백을 많이 줄수록 봇이 더 나은 답변을 생성합니다.
